<!-- backend/views/admin-login.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Login</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glass {
      backdrop-filter: blur(16px) saturate(150%);
      -webkit-backdrop-filter: blur(16px) saturate(150%);
      background: rgba(255,255,255,0.7);
    }
    @media (prefers-color-scheme: dark) {
      .glass { background: rgba(30,41,59,0.65); }
    }
  </style>
</head>

<body class="min-h-screen flex items-center justify-center
             bg-gradient-to-br from-sky-100 via-amber-100 to-rose-100
             dark:from-slate-900 dark:via-slate-800 dark:to-slate-900
             px-4">

  <div class="glass shadow-xl rounded-2xl p-10 w-full max-w-sm animate-[fadeIn_.6s_ease-out]">
    <h1 class="text-2xl font-semibold text-center text-slate-800 dark:text-slate-200 mb-8">
      Admin Login
    </h1>

    <!-- ✅ Wrap everything inside a form -->
    <form onsubmit="login(event)">
      <label class="block mb-4">
        <span class="sr-only">Username</span>
        <input id="user" autocomplete="off" placeholder="Username"
               class="w-full px-4 py-2 rounded-lg border border-slate-300
                      focus:outline-none focus:ring-2 focus:ring-amber-500
                      dark:bg-slate-700 dark:border-slate-600
                      dark:text-slate-100 dark:placeholder-slate-400">
      </label>

      <label class="block mb-6">
        <span class="sr-only">Password</span>
        <input id="pass" type="password" placeholder="Password"
               class="w-full px-4 py-2 rounded-lg border border-slate-300
                      focus:outline-none focus:ring-2 focus:ring-amber-500
                      dark:bg-slate-700 dark:border-slate-600
                      dark:text-slate-100 dark:placeholder-slate-400">
      </label>

      <button type="submit"
              class="w-full py-2 rounded-lg bg-amber-500 hover:bg-amber-600
                     text-white font-semibold tracking-wide transition">
        Sign in
      </button>

      <div id="err" class="text-rose-600 dark:text-rose-400 text-center mt-4 text-sm"></div>
    </form>
  </div>

  <script>
    function login(event) {
      event.preventDefault(); // ✅ Prevent form reload

      const u = document.getElementById('user').value.trim();
      const p = document.getElementById('pass').value.trim();

      if (!u || !p) {
        document.getElementById('err').textContent = 'Enter both fields';
        return;
      }

  fetch('/admin/login', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ username: u, password: p })
})
  .then(res => {
    if (!res.ok) throw new Error('Invalid credentials');
    return res.json();
  })
  .then(data => {
    if (data.success) {
      window.location = '/admin/registrations';
    }
  })
  .catch(() => {
    document.getElementById('err').textContent = 'Invalid login';
  });
    }
  </script>
</body>
</html>
